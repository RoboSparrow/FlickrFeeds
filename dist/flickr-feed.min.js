/**
 * FlickrFeeds - v0.0.1 - 2021-10-18
 * Copyright (c) 2021 
 * Licensed MIT <https://opensource.org/licenses/MIT>
 */


!function(t){"use strict";function s(t){return t.reduce(function(t,e){return t.indexOf(e)<0&&t.push(e.trim()),t},[])}function r(t){return t="string"==typeof(t=t||[])?-1<t.indexOf(",")?t.split(","):t.split(" "):t}function o(t){var e;if(this.error=!1,"string"==typeof t&&(e=/<title>(.*?)<\/title>/.exec(t),this.error=e||t),!this.error)for(var i in t)if(t.hasOwnProperty(i))if("items"!==i)this[i]=t[i];else{this.items=[];for(var s=0;s<t.items.length;s++)this.items.push(new n(t.items[s]))}}var h=t.document,p=[],u=function(t,e){var i,s=[];for(i in e)s.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return s.length?t+"?"+s.join("&"):u};o.prototype.getUsers=function(){for(var t=[],e=0;e<this.items.length;e++)t.push(this.items[e].getUser());return t.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})},o.prototype.getTags=function(t){for(var e=[],i=0;i<this.items.length;i++)e=e.concat(this.items[i].getTags());return s(e).sort()},o.prototype.getItemsByTags=function(t){for(var e=[],i=0;i<this.items.length;i++)this.items[i].hasTags(t)&&e.push(this.items[i]);return e};var n=function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])};n.prototype.getUser=function(){var t=/\(([^)]+)\)/.exec(this.author);return{id:this.author_id,name:t&&0<t.length?t[1]:this.author}},n.prototype.getImage=function(){return this.hasOwnProperty("media")&&this.media.hasOwnProperty("m")?this.media.m:null},n.prototype.getTags=function(){return r(this.tags)},n.prototype.hasTags=function(t){t=r(t);var e,i=this.getTags(t);return e=i,t.filter(function(t){return-1!=e.indexOf(t)}).length},n.prototype.getDatePublished=function(){return this.hasOwnProperty("published")?new Date(this.published):null},n.prototype.getDateTaken=function(){return this.hasOwnProperty("date_taken")?new Date(this.date_taken):null};function e(t){return this.state={raw:!1,inject:!1},this.query={},this.id=t,this.feed=null,this.endpoint=null,this.callback=function(t){},this}e.prototype.options=function(t){for(var e in t=t||{})t.hasOwnProperty(e)&&(this.query.hasOwnProperty(e)||(this.query[e]=t[e]))},e.prototype.register=function(t){this.feed=t,this.id=t.substr(t.lastIndexOf("/")+1)},e.prototype.prepareQuery=function(){var t,e=JSON.parse(JSON.stringify(this.query));switch(this.id){case"activity.gne":case"photos_friends.gne":case"photos_comments.gne":e.user_id=e.id,delete e.id}return void 0!==e.ids&&(e.ids=s(e.ids).join(",")),void 0!==e.tags&&(t=s(e.tags),e.tags=t.join(",")),e},e.prototype.raw=function(){return this.state.raw=!0,this},e.prototype.inject=function(t){return this.state.inject=t,this},e.prototype.ready=function(t){var e=this.prepareQuery();return function(t,e,i,s){e=e||{};var r=h.createElement("script"),n=function(t){s.inject&&(t.injected=s.inject),i(s.raw?t:new o(t)),h.head.removeChild(r)};p.push(n),e.format="json",e.jsoncallback="Flickr.callbacks["+(p.length-1)+"]",r.src=u(t,e),h.head.appendChild(r)}(this.feed,e,t,this.state),this},e.prototype.Photos=function(t){return t=t||!1,this.id||this.register("http://api.flickr.com/services/feeds/photos_public.gne"),this.options(t),this},e.prototype.User=function(t){return this.options({id:t}),this},e.prototype.Friends=function(t,e){return this.options({display_all:t||!1,friends:e?1:0}),this.register("https://api.flickr.com/services/feeds/photos_friends.gne"),this},e.prototype.Favourites=function(){return this.register("https://api.flickr.com/services/feeds/photos_faves.gne"),this},e.prototype.Activity=function(){return this.register("https://api.flickr.com/services/feeds/activity.gne"),this},e.prototype.Comments=function(){return this.register("https://api.flickr.com/services/feeds/photos_comments.gne"),this},e.prototype.Users=function(t){return t=r(t),this.options({ids:t}),this},e.prototype.Group=function(t){return this.options({id:t=t||[]}),this},e.prototype.Discussion=function(){return this.register("https://api.flickr.com/services/feeds/groups_discuss.gne"),this},e.prototype.Pool=function(){return this.register("https://api.flickr.com/services/feeds/groups_pool.gne"),this},e.prototype.Forums=function(){return this.register("https://api.flickr.com/services/feeds/forums.gne"),this},e.prototype.Tags=function(t,e){return t=r(t),this.options({tags:t,tagmode:(e=e||!1)?"ALL":"ANY"}),this},t.Flickr={callbacks:p,Feed:function(t){return new e(t)}}}(window);